%!PS-Adobe-2.0 EPSF-2.0
%%BoundingBox: 16 216 596 575
%%Creator: ImageMagick
%%Title: ex3-50.eps
%%EndComments
%
% Display a color image.  The image is displayed in color on
% Postscript viewers or printers that support color, otherwise
% it is displayed as grayscale.
%
/buffer 512 string def
/byte 1 string def
/color_packet 3 string def
/compression 1 string def
/gray_packet 1 string def
/pixels 768 string def

/DirectClassPacket
{
  %
  % Get a DirectClass packet.
  %
  % Parameters: 
  %   red.
  %   green.
  %   blue.
  %   length: number of pixels minus one of this color (optional).
  %
  currentfile color_packet readhexstring pop pop
  compression 0 gt
  {
    /number_pixels 3 def
  }
  {
    currentfile byte readhexstring pop 0 get
    /number_pixels exch 1 add 3 mul def
  } ifelse
  0 3 number_pixels 1 sub
  {
    pixels exch color_packet putinterval
  } for
  pixels 0 number_pixels getinterval
} bind def

/DirectClassImage
{
  %
  % Display a DirectClass image.
  %
  systemdict /colorimage known
  {
    columns rows 8
    [
      columns 0 0
      rows neg 0 rows
    ]
    { DirectClassPacket } false 3 colorimage
  }
  {
    %
    % No colorimage operator;  convert to grayscale.
    %
    columns rows 8
    [
      columns 0 0
      rows neg 0 rows
    ]
    { GrayDirectClassPacket } image
  } ifelse
} bind def

/GrayDirectClassPacket
{
  %
  % Get a DirectClass packet;  convert to grayscale.
  %
  % Parameters: 
  %   red
  %   green
  %   blue
  %   length: number of pixels minus one of this color (optional).
  %
  currentfile color_packet readhexstring pop pop
  color_packet 0 get 0.299 mul
  color_packet 1 get 0.587 mul add
  color_packet 2 get 0.114 mul add
  cvi
  /gray_packet exch def
  compression 0 gt
  {
    /number_pixels 1 def
  }
  {
    currentfile byte readhexstring pop 0 get
    /number_pixels exch 1 add def
  } ifelse
  0 1 number_pixels 1 sub
  {
    pixels exch gray_packet put
  } for
  pixels 0 number_pixels getinterval
} bind def

/GrayPseudoClassPacket
{
  %
  % Get a PseudoClass packet;  convert to grayscale.
  %
  % Parameters: 
  %   index: index into the colormap.
  %   length: number of pixels minus one of this color (optional).
  %
  currentfile byte readhexstring pop 0 get
  /offset exch 3 mul def
  /color_packet colormap offset 3 getinterval def
  color_packet 0 get 0.299 mul
  color_packet 1 get 0.587 mul add
  color_packet 2 get 0.114 mul add
  cvi
  /gray_packet exch def
  compression 0 gt
  {
    /number_pixels 1 def
  }
  {
    currentfile byte readhexstring pop 0 get
    /number_pixels exch 1 add def
  } ifelse
  0 1 number_pixels 1 sub
  {
    pixels exch gray_packet put
  } for
  pixels 0 number_pixels getinterval
} bind def

/PseudoClassPacket
{
  %
  % Get a PseudoClass packet.
  %
  % Parameters: 
  %   index: index into the colormap.
  %   length: number of pixels minus one of this color (optional).
  %
  currentfile byte readhexstring pop 0 get
  /offset exch 3 mul def
  /color_packet colormap offset 3 getinterval def
  compression 0 gt
  {
    /number_pixels 3 def
  }
  {
    currentfile byte readhexstring pop 0 get
    /number_pixels exch 1 add 3 mul def
  } ifelse
  0 3 number_pixels 1 sub
  {
    pixels exch color_packet putinterval
  } for
  pixels 0 number_pixels getinterval
} bind def

/PseudoClassImage
{
  %
  % Display a PseudoClass image.
  %
  % Parameters: 
  %   colors: number of colors in the colormap.
  %   colormap: red, green, blue color packets.
  %
  currentfile buffer readline pop
  token pop /colors exch def pop
  /colors colors 3 mul def
  /colormap colors string def
  currentfile colormap readhexstring pop pop
  systemdict /colorimage known
  {
    columns rows 8
    [
      columns 0 0
      rows neg 0 rows
    ]
    { PseudoClassPacket } false 3 colorimage
  }
  {
    %
    % No colorimage operator;  convert to grayscale.
    %
    columns rows 8
    [
      columns 0 0
      rows neg 0 rows
    ]
    { GrayPseudoClassPacket } image
  } ifelse
} bind def

/DisplayImage
{
  %
  % Display a DirectClass or PseudoClass image.
  %
  % Parameters: 
  %   x & y translation.
  %   x & y scale.
  %   image columns & rows.
  %   class: 0-DirectClass or 1-PseudoClass.
  %   compression: 0-RunlengthEncodedCompression or 1-NoCompression.
  %   hex color packets.
  %
  gsave
  currentfile buffer readline pop
  token pop /x exch def
  token pop /y exch def pop
  x y translate
  currentfile buffer readline pop
  token pop /x exch def
  token pop /y exch def pop
  x y scale
  currentfile buffer readline pop
  token pop /columns exch def
  token pop /rows exch def pop
  currentfile buffer readline pop
  token pop /class exch def pop
  currentfile buffer readline pop
  token pop /compression exch def pop
  class 0 gt { PseudoClassImage } { DirectClassImage } ifelse
  grestore
  showpage
} bind def

DisplayImage
16 216
580 359
110 68
1
0
41
989898
ffff66
606060
ffcb00
986600
cb9800
ffff33
000000
cbcb00
ffffff
e0e0e0
888888
336698
983366
ff3333
cb3333
ffcbcb
d8d8d8
666666
b8b8b8
006698
663366
663398
003398
ff3366
ff6666
ff6698
cb3366
c8c8c8
c0c0c0
98cbcb
9898cb
6698cb
f8f8f8
ff9898
cbcbff
e8e8e8
ff98cb
f0f0f0
cb0033
6666cb
006e016b02000000010003690400020000000100036904000200000001000301050d0349
05070307040002000000010003010500060c034905000607030604000200000001000301
050006090300050006000349050006030301050006000306040002000000010003010500
060603000600030006000500060003490500060203000600030005000600050403010400
0200000001000301050006050300060003000600030005000600031d05000700030a0500
0700031c0500060103000600030105000605030104000200000001000301050006040300
0600030305000600031d07000400030a07000400031c0500060003000600030205000603
050006000301040002000000010003010500060303000600030405000600031c05000700
08000309050007000800031c050006000304050006020300050006000301040002000000
010003010500060203000600030505000600031c07000400030a07000400031d05000600
050506010301050006000301040002000000010003010500060103000600030605000600
031b0500070008000309050007000800031e060703000600030005000600030104000200
00000100030105000602030705000600031a080007000500030908000700050003210500
060303000600030105000600030104000200000001000301050006010300060003060500
0600031a04000700030a0400070003220500060203000600030205000600030104000200
000001000301050006000300060003070500060003130700030207000301070005000303
070003020700030107000500030307000302070003000700030007000315050006010305
0500060003010400020000000100030105000600050a0600034c05000600050706000301
040002000000010003010500060c034c0500060903010400020000000100036904000200
00000100036904000200000009000a690b000200000009000a690b000200000009000a00
0b6609000a000b000200000009000a000b00006509000a000b000200000009000a000b00
00000c2a0d000e000f321000110012001300000009000a000b000200000009000a000b00
00000c29140015000e000f32100000001200000109000a000b000200000009000a000b00
00000c29140016000e000f32100000001200000109000a000b000200000009000a000b00
00000c2b0f3310000a0013001100000009000a000b000200000009000a000b0000000c2a
14000d000e000f3110000902000009000a000b000200000009000a000b0000000c2a1400
15000e000f3110000902000009000a000b000200000009000a000b0000000c06170c0c16
140015000e000f0c180019011a0019011b000f0f19030f0910000902000009000a000b00
0200000009000a000b0000000c0414000c001c001d001e001f021e001d001c011d001f00
20000c0014010c1314000c000f0b1900100021000905100022000f0b2200210009030a00
1a000f0710000902000009000a000b000200000009000a000b0000000c0620001f000a00
090221001f0020001f0023002100090021001d000c0014000c1214000c000f000e000f07
19000a0009000a00220019011b00190122000a000900240019000f081000090010001900
1b0019010a00090022000f0610000902000009000a000b000200000009000a000b000000
0c0617010c0021000901130017030c000a00090124000c0014000c130f000e000f062200
0900240019000f0819000a00090022000f062200090022000f052200090022000f051000
0902000009000a000b000200000009000a000b0000000c09240009011e0017000c021700
0c0009021e0014000c1214000d000e000f052200090010000f0c2500090022000f052600
10000f07220019000f0510000902000009000a000b000200000009000a000b0000000c09
0a0009011e0017000c0317001d00090126000c1314000d000e000f042200090022000f0e
2200090022000f031900090022000f0f10000902000009000a000b000200000009000a00
0b0000000c090a0009011e0017000c0317001f0009020c0014000c11140015000e000f03
1900090010000f101000090019000f022200090019000f0f10000902000009000a000b00
0200000009000a000b0000000c090a0009011e0017000c0317001f00090121000c131400
16000e000f031000090019000f11090010000f0219000900220027000f0e100009020000
09000a000b000200000009000a000b0000000c090a0009011e0017000c0317001e000901
230014000c0614020c08140016000e000f021900090025000f122200090019000f022600
0a000f0f10000902000009000a000b000200000009000a000b0000000c09110009011e00
17000c0214000c00240009002100280014000c0314010c0020010c0117000c0614000c00
0f032200090019000f121900090022000f0222000900100018000f0d1000090200000900
0a000b000200000009000a000b0000000c09110009011e001700140117011e0009002600
200014000c0317000c00230024001c00230026000a00200014000c0514000c000f031000
26000f140a0010000f03220021000900220018000f0b10000902000009000a000b000200
000009000a000b0000000c09110009011d000c0220001c0024001f000c0017000c031700
2000210011000c0017010c00240009001f0014000c0414000c000f03090010000f141000
26000f0418002500090122000f0a10000902000009000a000b000200000009000a000b00
00000c091100090126000a012400090026001f000c00170014000c0214000c0026002100
0c0014000c01170020000901280014000c0314000c000f03090025000f14100009001b00
0f05190010000900210022000f0810000902000009000a000b000200000009000a000b00
00000c09110009011e0017000c021f00210009001100280017000c0114001d0009001e00
170014021700280009011e0017000c0314000c000f03090025000f14100021000f081900
10000900210022000f0610000902000009000a000b000200000009000a000b0000000c09
110009011e0017000c01140017000c002400090021002000170014000c00260009001f00
0c041f00090111000c0414000c000f03210010000f14100024000f0a19000a0009002200
0f0510000902000009000a000b000200000009000a000b0000000c09110009011e001700
0c0317002000090121000c001700200009010a00230011020a0323000c0414000c000f03
100009000f14240010000f0c1000090019000f0410000902000009000a000b0002000000
09000a000b0000000c09110009011e0017000c041400230009011d0017001f0009002400
0c0014080c0414000c000f031900090019000f121900090022000f0d210010000f041000
0902000009000a000b000200000009000a000b0000000c090a0009011e0017000c041700
1d00090124000c001e00090024000c0014000c0c14000c000f04260010000f1210000900
0f0e100026000f0410000902000009000a000b000200000009000a000b0000000c090a00
09011e0017000c0417001e00090121000c001f00090026000c0014000c0c140016000e00
0f032200090019000f101900090022000f0e100026000f0410000902000009000a000b00
0200000009000a000b0000000c090a0009011e0017000c0417001d00090126000c002000
09011f0017000c0614000c04140016000e000f040a0026000f1026010f02190022000f0a
0a0010000f0410000902000009000a000b000200000009000a000b0000000c090a000901
1e0017000c0314000c000a000901230017002800090124000c0014000c04170020000c00
14000c02140015000e000f041900210024000f0e1000090019000f022200090019000f07
27001900090022000f0410000902000009000a000b000200000009000a000b0000000c09
240009011e0017000c0317001f000902200017000c001100090123000c00170014021700
200026000c0014000c0214000d000e000f0519000900260019000f0a1900260009001900
0f0426010f08240026000f0510000902000009000a000b000200000009000a000b000000
0c06140017000c00260009011e001700140017010c001f0009021f0017000c0014002800
210009010a0020000c021e0009001f0017000c0314000d000e000f0619000a0009001000
19000f06190010000900240019000f05190009000a0019000f0419002600090019000f05
10000902000009000a000b000200000009000a000b0000000c061f01110009031e001f01
1300260009012400200014000c0217002000260009061e0014000c050d000e000f082200
210009002600220424000900210022000f08190026000900100022020a00090024001900
0f0610000902000009000a000b000200000009000a000b0000000c0414000c001d011f04
1e001d0013001d0013001f0020000c0017000c0417000c001f0011002400260024001c00
280017000c0414000c000f000e000f0a1a00100024002100090021002400100022000f0c
22000a00210009002600100019000f0810000902000009000a000b000200000009000a00
0b0000000c06140017081400170214000c06140017000c0314010c0514000c000f321000
0902000009000a000b000200000009000a000b0000000c2a140016000e000f3110000902
000009000a000b000200000009000a000b0000000c2a140015000e000f31100009020000
09000a000b000200000009000a000b0000000c2a14000d000e000f311000090200000900
0a000b000200000009000a000b0000000c2b0f3310000902000009000a000b0002000000
09000a000b0000000c2914000c000f3310000902000009000a000b000200000009000a00
0b0000000c29140015000e000f3210000902000009000a000b000200000009000a000b00
00000c2914000d000e000f3210000902000009000a000b000200000009000a000b000065
09000a000b000200000009000a000b0009660a000b000200000009000a690b0002000000
0b6b026e

%%Trailer
